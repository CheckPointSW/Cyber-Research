ZigBee Classic Commissioning:
=============================
Brief:
------
During our research of [hacking smart lightbulbs](https://research.checkpoint.com/2020/dont-be-silly-its-only-a-lightbulb/), we reverse engineered the Classic Commissioning protocol used to pair a new Philips Hue lightbulb with it's controller (Philips Hue Bridge). Seeing there is lack of available information on the commissioning phase, we decided to open source our `.pcapng` file that records the entire protocol flow. The file also includes the decrypted messages and the negotiated crypto keys.

We hope that you will find this information useful for your research projects :)

Crypto Notes:
-------------
There are 2 types of keys that are used during the commissioning:
* **Transport Key** - A broadcast key that is shared in advance between all ZigBee light (ZLL) devices
* **Network Key** - A network specific key that is shared between all of the devices in a single ZigBee network, and is distributed by the bridge to the joining lightbulb

Details about the transport key could be found [here](https://peeveeone.com/?p=166). The network key is detailed (in clear-text) inside the attached `.pcapng` recording.

Network Details:
----------------
The network addresses of the **bridge** in the recording are:
* **Long address**: `00:17:88:01:01:69:13:59`
* **Short address**: `0x0001`
* **PAN ID**: `0x949F`

The network addresses of the **lightbulb** in the recording are:
* **Long address**: `00:17:88:01:01:04:3D:07`
* **Short address**: `0x0125`

Exploit Demo (CVE-2020-6007):
-----------------------------
A demo video of our exploit could be found here:
[https://youtu.be/4CWU0DA__bY](https://youtu.be/4CWU0DA__bY)
